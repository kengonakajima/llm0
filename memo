結果memo


python3 train_bigram.py --steps 200 --batch-size 8192 --lr 0.03 --temperature 1.0

5000	1.4354


./.venv/bin/python train_transformer.py --steps 1000 --block-size 256 --batch-size 256 --n-layer 4 --n-head 4 --n-embd 256 --lr 6e-4

1000	1.0954



./.venv/bin/python train_transformer.py --steps 2000 --block-size 512 --batch-size 256 --n-layer 6 --n-head 8 --n-embd 512 --lr 3e-4

これは動かない



# 早期停止を入れた。
./.venv/bin/python train_transformer.py --steps 10000 --block-size 256 --batch-size 256 --n-layer 4 --n-head 4 --n-embd 256 --lr 6e-4

train:  22% 2199/10000 [23:56<1:24:57,  1.53it/s, step=2000 loss=0.7192]
[Finished] steps=10000, final_loss=0.6303, elapsed=1436.80s, val_loss=2.1621, val_ppl=8.69



